# 弹幕刮削

![main page](doc/page.png)

此插件根据文件匹配弹弹平台上的弹幕,将弹幕文件转换为ass格式字幕,用于实现在不支持弹幕播放的设备上模拟弹幕.

### 手动匹配与搜索
- 前端支持搜索弹弹番剧并手动匹配，可选“目录”或“单文件”范围；单文件仅作用于该文件。
- 手动匹配数据保存在目录下 `.dandan.anime.json`（旧 `.id` 会自动转换并删除）；单文件匹配存储在插件缓存。
- 生成的弹幕文件为 UTF-8 无 BOM `.danmu.ass`，合并中文字幕时为原字幕事件补充 `{\blur10}` 提升可读性。

### 文件匹配规则
首先会尝试使用文件hash直接匹配文件,如果没有匹配到怎会尝试使用TMDB ID来进行匹配.



### 更新日志

-  v1.6.1: 弹幕文件改为 UTF-8 无 BOM，合并中文字幕时增加 `{\blur10}` 模糊标签
-  v1.6.0: UI 支持手动匹配范围选择（目录/单文件），兼容 `.dandan.anime.json` 存储
-  v1.4.0: 修复文件路径无法访问的问题,新增无弹幕或者弹幕数量过少时定时重试
-  v1.3.0: 新增联邦组件支持, 增加UI手动刮削, 需求MP v2.4.5+
-  v1.2.0: 针对新番（90天内发布的媒体资源）使用较短时间缓存以获取最新弹幕数据
-  v1.1.15: 增加根据路径刮削弹幕功能。增加单文件路径刮削。能力有限无法在同一个页面实现按钮功能……
-  v1.1.13: 先检查当前目录下有没有.id结尾的文件 如果有，则获取文件名作为弹幕ID（如190270001 则使用19027.id)。如果需要请访问 https://dandanapi.hankun.online/docs 尝试获取epsoide id。
-  v1.1.11: 修复弹幕获取过滤错误
-  v1.1.10: 使用TMDB ID作为预备匹配方案，当无法匹配文件hash时尝试使用TMDB ID。
-  v1.1.8: 增加了中转服务器，恢复了对弹弹的访问以及缓存。修复透明度问题。增加了弹幕过滤选项。
